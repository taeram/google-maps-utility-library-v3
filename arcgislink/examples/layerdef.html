<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <title>Layer Definition</title>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
        </script>
        <script type="text/javascript">
         document.write('<script type="text/javascript" src="../src/arcgislink'+(document.location.search.indexOf('compiled')>-1?'_compiled':'')+'.js"><'+'/script>');
        </script>
        <script type="text/javascript">
        var dynamap;
        var dynamap2;
        var map;
        
        function init() {
          var myOptions = {
            zoom: 6,
            center: new google.maps.LatLng(38, -98),
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            streetViewControl: true
          };
          map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
          var url = 'http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Demographics/ESRI_Census_USA/MapServer';
          dynamap = new gmaps.ags.MapOverlay(url);
          // set definition after map service load event.
          google.maps.event.addListenerOnce(dynamap.mapService, 'load', function(){
            var service = dynamap.mapService;
            service.getLayer("Coarse Counties").definition = "STATE_NAME='Kansas' and POP2007>25000";
            service.getLayer("Detailed Counties").definition = "STATE_NAME='Kansas' and POP2007>25000";
            service.getLayer("states").definition = "STATE_NAME='Kansas'";
            dynamap.setMap(map);
          });
          
          // set definitions in constructor, hard coded layer ids.
          dynamap2 = new gmaps.ags.MapOverlay(url, {
            exportOptions: {
              layerIds:[5,4,3],
              layerOption: 'show',
              layerDefinitions: {
                '5': "STATE_NAME='New Mexico'",
                '4': "STATE_NAME='New Mexico' and POP2007>25000",
                '3': "STATE_NAME='New Mexico' and POP2007>25000"
              }
            }
          });
          dynamap2.setMap(map);
          
        }
        </script>
  </head>
 <body style="margin:0px; padding:0px;" onload="init()">
        <div id="map_canvas" style="width:100%; height:100%">
        </div>
    </body>
</html>